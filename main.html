mapboxgl.accessToken = 'DEIN_MAPBOX_ACCESS_TOKEN';

const map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v12',
  center: [10.0, 50.0], // Setze die Startkoordinaten
  zoom: 12
});

// Route konfigurieren
const route = {
  type: 'Feature',
  geometry: {
    type: 'LineString',
    coordinates: [
      [10.0, 50.0], // Beispielkoordinaten
      [10.1, 50.1],
      [10.2, 50.0]
    ]
  }
};

// Route als Layer hinzufügen
map.on('load', () => {
  map.addSource('route', {
    type: 'geojson',
    data: route
  });

  map.addLayer({
    id: 'route',
    type: 'line',
    source: 'route',
    layout: { 'line-join': 'round', 'line-cap': 'round' },
    paint: { 'line-color': '#007cbf', 'line-width': 5 }
  });

  // Checkpoints hinzufügen
  route.geometry.coordinates.forEach(coord => {
    new mapboxgl.Marker().setLngLat(coord).addTo(map);
  });

  // Aktuelle Position
  if (navigator.geolocation) {
    navigator.geolocation.watchPosition(position => {
      const userLocation = [position.coords.longitude, position.coords.latitude];

      // Benutzerposition anzeigen
      new mapboxgl.Marker({ color: 'red' })
        .setLngLat(userLocation)
        .addTo(map);

      map.flyTo({ center: userLocation });
    });
  }
});
